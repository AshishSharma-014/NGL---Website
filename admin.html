<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - New Goodluck Furniture</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="admin.css">
    <script src="https://kit.fontawesome.com/cc5bde920c.js" crossorigin="anonymous"></script>

</head>

<body>

    <div id="login-screen">
        <div class="login-box">
            <div style="font-size: 3rem; color: #D4AE37; margin-bottom: 10px;"><i class="fa-solid fa-lock"></i></div>
            <h2>Admin Login</h2>
            <input type="text" id="username" placeholder="Username (admin)">
            <input type="password" id="password" placeholder="Password (admin123)">
            <button class="login-btn" onclick="checkLogin()">UNLOCK DASHBOARD</button>
            <p id="login-error" style="color: #ff5555; display: none; margin-top: 10px;">Incorrect credentials!</p>
        </div>
    </div>

    <div id="admin-panel" style="display: none;">

        <div class="sidebar">
            <div class="logo">NGL <span>ADMIN</span></div>
            <div class="menu-item active" onclick="showSection('dashboard')"><i class="fa-solid fa-chart-line"></i>
                Dashboard</div>
            <div class="menu-item" onclick="showSection('add-product')"><i class="fa-solid fa-plus"></i> Add Product
            </div>
            <div class="menu-item" onclick="showSection('manage-products')"><i class="fa-solid fa-list"></i> Manage
                Products</div>
            <div class="menu-item" onclick="window.location.href='products.html'"><i class="fa-solid fa-eye"></i> View
                Website</div>
            <div class="menu-item logout" onclick="location.reload()"><i class="fa-solid fa-right-from-bracket"></i>
                Logout</div>
        </div>

        <div class="main-content" id="main-content-area" style="display: block;">

            <div id="dashboard-section">
                <div class="header">
                    <h2>Dashboard Overview</h2>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3 id="total-products">10</h3>
                        <p>Total Products</p>
                    </div>
                    <div class="stat-card">
                        <h3>8</h3>
                        <p>Categories</p>
                    </div>
                    <div class="stat-card">
                        <h3 style="color: #25D366;">Active</h3>
                        <p>System Status</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 50px; color: #555;">
                    <i class="fa-solid fa-box-open fa-3x"></i>
                    <p>Welcome, Admin. System is running.</p>
                </div>
            </div>

            <div id="add-product-section" class="form-container" style="display: none;">
                <div class="header">
                    <h2 id="form-title">Add New Product</h2>
                </div>
                <form onsubmit="handleFormSubmit(event)">
                    <input type="hidden" id="edit-index" value="-1">

                    <div class="form-group"><label>Product Name</label><input type="text" id="p-name"
                            placeholder="e.g. Royal Teak Bed" required></div>
                    <div class="row">
                        <div class="col form-group"><label>Price (₹)</label><input type="number" id="p-price"
                                placeholder="25000" required></div>
                        <div class="col form-group">
                            <label>Category</label>
                            <select id="p-category">
                                <option value="bed">Bed</option>
                                <option value="sofa">Sofa</option>
                                <option value="dressing">Dressing Table</option>
                                <option value="dining">Dining Table</option>
                                <option value="wardrobe">Wardrobe</option>
                                <option value="kitchen">Kitchen</option>
                                <option value="drawing_room">Drawing Room</option>
                                <option value="living_room">Living Room</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group"><label>Size</label><input type="text" id="p-size"
                            placeholder="e.g. King Size" required></div>
                    <div class="form-group"><label>Main Image Path</label><input type="text" id="p-img-main"
                            placeholder="/Resources/bed1.jpg" required></div>
                    <div class="row">
                        <div class="col form-group"><label>Thumb 1</label><input type="text" id="p-img-1"
                                placeholder="/Resources/bed2.jpg"></div>
                        <div class="col form-group"><label>Thumb 2</label><input type="text" id="p-img-2"
                                placeholder="/Resources/bed3.jpg"></div>
                        <div class="col form-group"><label>Thumb 3</label><input type="text" id="p-img-3"
                                placeholder="/Resources/bed4.jpg"></div>
                    </div>
                    <div class="form-group"><label>Description</label><textarea id="p-desc" rows="3"
                            placeholder="Enter the description."></textarea></div>
                    <div class="form-group"><label>Specifications(Separated with commas)</label><textarea id="p-specs"
                            rows="2" placeholder="Quality: Good, Warranty: 5 years"></textarea>
                    </div>
                    <button type="submit" id="submit-btn" class="submit-btn">ADD PRODUCT</button>
                    <button type="button" onclick="resetForm()"
                        style="background:none; border:none; color:#777; width:100%; margin-top:10px; cursor:pointer;">Cancel</button>
                </form>
            </div>

            <div id="manage-products-section" style="display: none;">
                <div class="header">
                    <h2>Manage Products</h2>
                </div>
                <div style="background-color: #2A2A2A; padding: 20px; border-radius: 15px;">
                    <table class="product-table">
                        <thead>
                            <tr>
                                <th>Product Details</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="product-table-body">
                        </tbody>
                    </table>
                    <p id="empty-msg" style="text-align: center; color: #555; margin-top: 20px;">No products added yet.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="alert"><i class="fa-solid fa-check-circle"></i> Success!</div>

    <script>
        // 1. LOGIN
        function checkLogin() {
            const user = document.getElementById('username').value;
            const pass = document.getElementById('password').value;
            if (user === 'admin' && pass === 'admin123') {
                document.getElementById('login-screen').style.display = 'none';
                document.getElementById('admin-panel').style.display = 'flex';
                updateStats();
            } else {
                document.getElementById('login-error').style.display = 'block';
            }
        }

        // 2. NAVIGATE
        function showSection(sectionId) {
            document.getElementById('dashboard-section').style.display = 'none';
            document.getElementById('add-product-section').style.display = 'none';
            document.getElementById('manage-products-section').style.display = 'none';
            document.querySelectorAll('.menu-item').forEach(el => el.classList.remove('active'));

            if (sectionId === 'dashboard') {
                document.getElementById('dashboard-section').style.display = 'block';
                document.querySelectorAll('.menu-item')[0].classList.add('active');
                updateStats();
            }
            else if (sectionId === 'add-product') {
                resetForm();
                document.getElementById('add-product-section').style.display = 'block';
                document.querySelectorAll('.menu-item')[1].classList.add('active');
            }
            else if (sectionId === 'manage-products') {
                document.getElementById('manage-products-section').style.display = 'block';
                document.querySelectorAll('.menu-item')[2].classList.add('active');
                renderTable();
            }
        }

        // 3. SUBMIT FORM
        function handleFormSubmit(e) {
            e.preventDefault();
            const newProduct = {
                id: Date.now(),
                name: document.getElementById('p-name').value,
                price: document.getElementById('p-price').value,
                category: document.getElementById('p-category').value,
                size: document.getElementById('p-size').value,
                imgMain: document.getElementById('p-img-main').value,
                img1: document.getElementById('p-img-1').value || document.getElementById('p-img-main').value,
                img2: document.getElementById('p-img-2').value || document.getElementById('p-img-main').value,
                img3: document.getElementById('p-img-3').value || document.getElementById('p-img-main').value,
                desc: document.getElementById('p-desc').value,
                specs: document.getElementById('p-specs').value
            };

            let products = JSON.parse(localStorage.getItem('ngl_products') || "[]");
            const editIndex = document.getElementById('edit-index').value;

            if (editIndex == "-1") {
                products.push(newProduct);
                showAlert("Product Added!");
            } else {
                products[editIndex] = newProduct;
                showAlert("Product Updated!");
            }

            localStorage.setItem('ngl_products', JSON.stringify(products));
            resetForm();
            if (editIndex != "-1") showSection('manage-products');
        }

        // 4. RENDER TABLE WITH IMAGES
        function renderTable() {
            const products = JSON.parse(localStorage.getItem('ngl_products') || "[]");
            const tbody = document.getElementById('product-table-body');
            tbody.innerHTML = "";

            if (products.length > 0) {
                document.getElementById('empty-msg').style.display = 'none';
                products.forEach((prod, index) => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>
                            <img src="${prod.imgMain}" class="table-thumb" onerror="this.src='https://via.placeholder.com/50'">
                            ${prod.name}
                        </td>
                        <td style="text-transform:capitalize">${prod.category.replace('_', ' ')}</td>
                        <td>₹ ${prod.price}</td>
                        <td>
                            <button class="action-btn edit-btn" onclick="editProduct(${index})"><i class="fa-solid fa-pen"></i></button>
                            <button class="action-btn delete-btn" onclick="deleteProduct(${index})"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } else {
                document.getElementById('empty-msg').style.display = 'block';
            }
        }

        // 5. EDIT
        function editProduct(index) {
            const products = JSON.parse(localStorage.getItem('ngl_products') || "[]");
            const prod = products[index];
            showSection('add-product');
            document.getElementById('p-name').value = prod.name;
            document.getElementById('p-price').value = prod.price;
            document.getElementById('p-category').value = prod.category;
            document.getElementById('p-size').value = prod.size;
            document.getElementById('p-img-main').value = prod.imgMain;
            document.getElementById('p-img-1').value = prod.img1;
            document.getElementById('p-img-2').value = prod.img2;
            document.getElementById('p-img-3').value = prod.img3;
            document.getElementById('p-desc').value = prod.desc;
            document.getElementById('p-specs').value = prod.specs;
            document.getElementById('edit-index').value = index;
            document.getElementById('form-title').innerText = "Edit Product";
            document.getElementById('submit-btn').innerText = "UPDATE PRODUCT";
            document.getElementById('submit-btn').classList.add('update');
        }

        // 6. DELETE
        function deleteProduct(index) {
            if (confirm("Delete this product?")) {
                let products = JSON.parse(localStorage.getItem('ngl_products') || "[]");
                products.splice(index, 1);
                localStorage.setItem('ngl_products', JSON.stringify(products));
                renderTable();
                showAlert("Deleted!");
            }
        }

        // 7. HELPERS
        function resetForm() {
            document.querySelector('form').reset();
            document.getElementById('edit-index').value = "-1";
            document.getElementById('form-title').innerText = "Add New Product";
            document.getElementById('submit-btn').innerText = "ADD PRODUCT";
            document.getElementById('submit-btn').classList.remove('update');
        }

        // REPLACE YOUR OLD updateStats() FUNCTION WITH THIS:

        function updateStats() {
            let products = JSON.parse(localStorage.getItem('ngl_products') || "[]");

            // 1. Count the products you manually coded in HTML (Bed, Sofa, Dining, etc.)
            // You said you have exactly 10 hardcoded products.
            const STATIC_COUNT = 9;

            // 2. Add the new products you created in the Admin Panel
            const dynamicCount = products.length;

            // 3. Total
            const total = STATIC_COUNT + dynamicCount;

            document.getElementById('total-products').innerText = total;
        }
        function showAlert(msg) {
            const alertBox = document.getElementById('alert');
            alertBox.innerHTML = `<i class="fa-solid fa-check-circle"></i> ${msg}`;
            alertBox.style.display = 'block';
            setTimeout(() => { alertBox.style.display = 'none'; }, 3000);
        }
        // --- ADD THIS AT THE BOTTOM OF YOUR SCRIPT ---
        
        // Listen for "Enter" key on the password field
        document.getElementById('password').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                checkLogin();
            }
        });
    </script>
</body>

</html>